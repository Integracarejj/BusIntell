{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/JeremyJoyner/code/budgetintelligence/components/BudgetGrid.tanstack.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/BudgetGrid.tanstack.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/BudgetGrid.tanstack.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAsS,GACnU,oEACA","ignoreList":[0]}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/JeremyJoyner/code/budgetintelligence/components/BudgetGrid.tanstack.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/BudgetGrid.tanstack.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/BudgetGrid.tanstack.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAkR,GAC/S,gDACA","ignoreList":[0]}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/JeremyJoyner/code/budgetintelligence/app/agm/budget/page.tsx"],"sourcesContent":["\r\n// app/agm/budget/page.tsx\r\n// Server Component (App Router) — loads mock data, shows summary cards, mounts BudgetGrid (TanStack).\r\n// NOTE: We now import the TanStack grid component, NOT the AG Grid one.\r\n\r\nexport const runtime = \"nodejs\";\r\n\r\nimport { promises as fs } from \"fs\";\r\nimport path from \"path\";\r\nimport BudgetGrid, { type BudgetLine } from \"../../../components/BudgetGrid.tanstack\";\r\n\r\n// ---- helpers (kept local; we can move to /lib later) ----\r\nasync function loadBudgetLines(): Promise<BudgetLine[]> {\r\n    const filePath = path.join(process.cwd(), \"data\", \"budgetLines.json\");\r\n    const raw = await fs.readFile(filePath, \"utf-8\");\r\n    const json = JSON.parse(raw);\r\n\r\n    // Normalize shapes to a single array:\r\n    // A) Flat array\r\n    if (Array.isArray(json)) return json as BudgetLine[];\r\n    // B) { revenues: [], expenses: [] } or { lines: [] }\r\n    const lines: BudgetLine[] = [];\r\n    if (Array.isArray(json.revenues)) lines.push(...json.revenues);\r\n    if (Array.isArray(json.expenses)) lines.push(...json.expenses);\r\n    if (Array.isArray(json.lines)) lines.push(...json.lines);\r\n    return lines;\r\n}\r\n\r\nfunction sumAmount(lines: BudgetLine[], kind: BudgetLine[\"type\"]) {\r\n    return lines.reduce((acc, l) => {\r\n        if (l.type === kind && typeof l.amount === \"number\") acc += l.amount;\r\n        return acc;\r\n    }, 0);\r\n}\r\n\r\nfunction fmtCurrency(n: number) {\r\n    return new Intl.NumberFormat(\"en-US\", {\r\n        style: \"currency\",\r\n        currency: \"USD\",\r\n        maximumFractionDigits: 0,\r\n    }).format(n);\r\n}\r\n\r\n/**\r\n * Optional: clone an additional 2025 dataset from the base lines.\r\n * - If period is \"YYYY-MM\" -> replace the year with \"2025\"\r\n * - If period is \"YYYY\"    -> set to \"2025\"\r\n * - If null/number         -> tag as \"2025\"\r\n * You can comment this out if you don't want 2025 mock data yet.\r\n */\r\nfunction with2025(lines: BudgetLine[], upliftPct?: number): BudgetLine[] {\r\n    const uplift = typeof upliftPct === \"number\" ? 1 + upliftPct / 100 : 1;\r\n    const replaceYear = (p: string) => p.replace(/^\\d{4}/, \"2025\");\r\n    const clones: BudgetLine[] = [];\r\n\r\n    for (const d of lines) {\r\n        let period: string | number | null = d.period ?? null;\r\n        if (typeof period === \"string\") {\r\n            if (/^\\d{4}-\\d{2}$/.test(period)) period = replaceYear(period);\r\n            else if (/^\\d{4}$/.test(period)) period = \"2025\";\r\n        } else {\r\n            period = \"2025\";\r\n        }\r\n        const amount =\r\n            typeof d.amount === \"number\" ? Math.round(d.amount * uplift) : d.amount ?? null;\r\n\r\n        clones.push({ ...d, period, amount });\r\n    }\r\n    return [...lines, ...clones];\r\n}\r\n\r\nexport default async function AgmBudgetPage() {\r\n    const baseLines = await loadBudgetLines();\r\n\r\n    // Toggle 2025 mocks by switching between these two lines:\r\n    // const lines = baseLines;                 // ← no 2025\r\n    const lines = with2025(baseLines, /* uplift % */ undefined); // ← add 2025 copy (no uplift)\r\n\r\n    const totalRevenue = sumAmount(lines, \"revenue\");\r\n    const totalExpense = sumAmount(lines, \"expense\");\r\n    const net = totalRevenue - totalExpense;\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Page title */}\r\n            <header className=\"space-y-1\">\r\n                <h1 className=\"text-xl font-semibold text-slate-900\">Budget</h1>\r\n                <p className=\"text-sm text-slate-600\">\r\n                    Review and update budget lines by community, category, and period.\r\n                </p>\r\n            </header>\r\n\r\n            {/* Summary cards */}\r\n            <section\r\n                aria-label=\"Budget summary\"\r\n                className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3\"\r\n            >\r\n                <Card title=\"Total Revenue\" value={fmtCurrency(totalRevenue)} testId=\"card-total-revenue\" />\r\n                <Card title=\"Total Expense\" value={fmtCurrency(totalExpense)} testId=\"card-total-expense\" />\r\n                <Card title=\"Net\" value={fmtCurrency(net)} testId=\"card-net\" />\r\n            </section>\r\n\r\n            {/* TanStack Grid mount */}\r\n            <section\r\n                aria-label=\"Budget grid\"\r\n                className=\"space-y-3 rounded-xl border border-slate-200 bg-white p-4 shadow-sm\"\r\n            >\r\n                <div className=\"flex items-center justify-between\">\r\n                    <h2 className=\"text-base font-semibold text-slate-900\">Budget Lines</h2>\r\n                    <p className=\"text-xs text-slate-500\">\r\n                        {lines.length} rows · {new Set(lines.map((l) => l.community)).size} communities\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Mount the TanStack grid (safer side-by-side with old grid while you test) */}\r\n                <BudgetGrid rows={lines} />\r\n            </section>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction Card({\r\n    title,\r\n    value,\r\n    testId,\r\n}: {\r\n    title: string;\r\n    value: string;\r\n    testId?: string;\r\n}) {\r\n    return (\r\n        <div\r\n            className=\"rounded-xl border border-slate-200 bg-white p-4 shadow-sm\"\r\n            data-testid={testId}\r\n        >\r\n            <p className=\"text-xs font-medium uppercase tracking-wide text-slate-500\">\r\n                {title}\r\n            </p>\r\n            <p className=\"mt-1 text-2xl font-semibold text-slate-900\">{value}</p>\r\n        </div>\r\n    );\r\n}\r\n``\r\n"],"names":[],"mappings":"AACA,0BAA0B;AAC1B,sGAAsG;AACtG,wEAAwE;;;;;;;;AAIxE;AACA;AACA;;AAJO,MAAM,UAAU;;;;AAMvB,4DAA4D;AAC5D,eAAe;IACX,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;IAClD,MAAM,MAAM,MAAM,yGAAE,CAAC,QAAQ,CAAC,UAAU;IACxC,MAAM,OAAO,KAAK,KAAK,CAAC;IAExB,sCAAsC;IACtC,gBAAgB;IAChB,IAAI,MAAM,OAAO,CAAC,OAAO,OAAO;IAChC,qDAAqD;IACrD,MAAM,QAAsB,EAAE;IAC9B,IAAI,MAAM,OAAO,CAAC,KAAK,QAAQ,GAAG,MAAM,IAAI,IAAI,KAAK,QAAQ;IAC7D,IAAI,MAAM,OAAO,CAAC,KAAK,QAAQ,GAAG,MAAM,IAAI,IAAI,KAAK,QAAQ;IAC7D,IAAI,MAAM,OAAO,CAAC,KAAK,KAAK,GAAG,MAAM,IAAI,IAAI,KAAK,KAAK;IACvD,OAAO;AACX;AAEA,SAAS,UAAU,KAAmB,EAAE,IAAwB;IAC5D,OAAO,MAAM,MAAM,CAAC,CAAC,KAAK;QACtB,IAAI,EAAE,IAAI,KAAK,QAAQ,OAAO,EAAE,MAAM,KAAK,UAAU,OAAO,EAAE,MAAM;QACpE,OAAO;IACX,GAAG;AACP;AAEA,SAAS,YAAY,CAAS;IAC1B,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QAClC,OAAO;QACP,UAAU;QACV,uBAAuB;IAC3B,GAAG,MAAM,CAAC;AACd;AAEA;;;;;;CAMC,GACD,SAAS,SAAS,KAAmB,EAAE,SAAkB;IACrD,MAAM,SAAS,OAAO,cAAc,WAAW,IAAI,YAAY,MAAM;IACrE,MAAM,cAAc,CAAC,IAAc,EAAE,OAAO,CAAC,UAAU;IACvD,MAAM,SAAuB,EAAE;IAE/B,KAAK,MAAM,KAAK,MAAO;QACnB,IAAI,SAAiC,EAAE,MAAM,IAAI;QACjD,IAAI,OAAO,WAAW,UAAU;YAC5B,IAAI,gBAAgB,IAAI,CAAC,SAAS,SAAS,YAAY;iBAClD,IAAI,UAAU,IAAI,CAAC,SAAS,SAAS;QAC9C,OAAO;YACH,SAAS;QACb;QACA,MAAM,SACF,OAAO,EAAE,MAAM,KAAK,WAAW,KAAK,KAAK,CAAC,EAAE,MAAM,GAAG,UAAU,EAAE,MAAM,IAAI;QAE/E,OAAO,IAAI,CAAC;YAAE,GAAG,CAAC;YAAE;YAAQ;QAAO;IACvC;IACA,OAAO;WAAI;WAAU;KAAO;AAChC;AAEe,eAAe;IAC1B,MAAM,YAAY,MAAM;IAExB,0DAA0D;IAC1D,wDAAwD;IACxD,MAAM,QAAQ,SAAS,WAAW,YAAY,GAAG,YAAY,8BAA8B;IAE3F,MAAM,eAAe,UAAU,OAAO;IACtC,MAAM,eAAe,UAAU,OAAO;IACtC,MAAM,MAAM,eAAe;IAE3B,qBACI,8OAAC;QAAI,WAAU;;0BAEX,8OAAC;gBAAO,WAAU;;kCACd,8OAAC;wBAAG,WAAU;kCAAuC;;;;;;kCACrD,8OAAC;wBAAE,WAAU;kCAAyB;;;;;;;;;;;;0BAM1C,8OAAC;gBACG,cAAW;gBACX,WAAU;;kCAEV,8OAAC;wBAAK,OAAM;wBAAgB,OAAO,YAAY;wBAAe,QAAO;;;;;;kCACrE,8OAAC;wBAAK,OAAM;wBAAgB,OAAO,YAAY;wBAAe,QAAO;;;;;;kCACrE,8OAAC;wBAAK,OAAM;wBAAM,OAAO,YAAY;wBAAM,QAAO;;;;;;;;;;;;0BAItD,8OAAC;gBACG,cAAW;gBACX,WAAU;;kCAEV,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAG,WAAU;0CAAyC;;;;;;0CACvD,8OAAC;gCAAE,WAAU;;oCACR,MAAM,MAAM;oCAAC;oCAAS,IAAI,IAAI,MAAM,GAAG,CAAC,CAAC,IAAM,EAAE,SAAS,GAAG,IAAI;oCAAC;;;;;;;;;;;;;kCAK3E,8OAAC,gJAAU;wBAAC,MAAM;;;;;;;;;;;;;;;;;;AAIlC;AAEA,SAAS,KAAK,EACV,KAAK,EACL,KAAK,EACL,MAAM,EAKT;IACG,qBACI,8OAAC;QACG,WAAU;QACV,eAAa;;0BAEb,8OAAC;gBAAE,WAAU;0BACR;;;;;;0BAEL,8OAAC;gBAAE,WAAU;0BAA8C;;;;;;;;;;;;AAGvE;AACA,EAAE"}}]
}