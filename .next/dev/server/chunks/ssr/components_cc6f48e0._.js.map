{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/JeremyJoyner/code/budgetintelligence/components/grid/ToolbarFilters.tsx"],"sourcesContent":["\r\n\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport type { ColumnFiltersState, Table } from \"@tanstack/react-table\";\r\n\r\ntype Option = { label: string; value: string };\r\n\r\ntype ToolbarFiltersProps<TData extends object> = {\r\n    /** TanStack Table instance so we can derive options contextually (esp. Category) */\r\n    table: Table<TData>;\r\n    /** Current columnFilters state from the grid */\r\n    filters: ColumnFiltersState;\r\n    /** Setter from the grid */\r\n    setFilters: React.Dispatch<React.SetStateAction<ColumnFiltersState>>;\r\n    /** UI actions provided by the grid */\r\n    onClear: () => void;\r\n    onExport: () => void;\r\n    /** Optional override lists */\r\n    yearOptions?: string[];             // default: [\"2024\",\"2025\",\"2026\"]\r\n    typeOptions?: string[];             // default: [\"expense\",\"revenue\",\"home office\"]\r\n    /** Field accessors (defaults match your dataset) */\r\n    communityColumnId?: string;         // default: \"community\"\r\n    typeColumnId?: string;              // default: \"type\"\r\n    categoryColumnId?: string;          // default: \"category\"\r\n    yearHelperColumnId?: string;        // default: \"__year\"\r\n};\r\n\r\nexport default function ToolbarFilters<TData extends object>({\r\n    table,\r\n    filters,\r\n    setFilters,\r\n    onClear,\r\n    onExport,\r\n    yearOptions = [\"2024\", \"2025\", \"2026\"],\r\n    typeOptions = [\"expense\", \"revenue\", \"home office\"],\r\n    communityColumnId = \"community\",\r\n    typeColumnId = \"type\",\r\n    categoryColumnId = \"category\",\r\n    yearHelperColumnId = \"__year\",\r\n}: ToolbarFiltersProps<TData>) {\r\n    // ----- helpers -----\r\n    const getFilter = React.useCallback(\r\n        (id: string) => filters.find((f) => f.id === id)?.value as any,\r\n        [filters]\r\n    );\r\n\r\n    const setFilter = React.useCallback(\r\n        (id: string, value: any) => {\r\n            setFilters((old) => {\r\n                const others = old.filter((f) => f.id !== id);\r\n                if (value == null || (Array.isArray(value) && value.length === 0)) return others;\r\n                return [...others, { id, value }];\r\n            });\r\n            // clear row selection when filters change\r\n            table.resetRowSelection();\r\n        },\r\n        [setFilters, table]\r\n    );\r\n\r\n    // ----- current selections -----\r\n    const selectedCommunities: string[] = (getFilter(communityColumnId) as string[]) ?? [];\r\n    const selectedYear: string | null = (getFilter(yearHelperColumnId) as string | null) ?? null;\r\n    const selectedType: string | null = (getFilter(typeColumnId) as string | null) ?? null;\r\n    const selectedCategories: string[] = (getFilter(categoryColumnId) as string[]) ?? [];\r\n\r\n    // ----- option derivation -----\r\n    const communityOptions: Option[] = React.useMemo(() => {\r\n        const set = new Set<string>();\r\n        table.getPreFilteredRowModel().rows.forEach((r) => {\r\n            const v = String(r.getValue(communityColumnId) ?? \"\");\r\n            if (v) set.add(v);\r\n        });\r\n        return Array.from(set).sort((a, b) => a.localeCompare(b)).map((v) => ({ value: v, label: v }));\r\n    }, [table, communityColumnId]);\r\n\r\n    const yearOpts: Option[] = React.useMemo(\r\n        () => yearOptions.map((y) => ({ value: y, label: y })),\r\n        [yearOptions]\r\n    );\r\n\r\n    const typeOpts: Option[] = React.useMemo(\r\n        () => typeOptions.map((t) => ({ value: t, label: t })),\r\n        [typeOptions]\r\n    );\r\n\r\n    // Category options reflect current (Community, Year, Type)\r\n    const categoryOptions: Option[] = React.useMemo(() => {\r\n        const rows = table.getPreFilteredRowModel().rows.filter((r) => {\r\n            const commPass =\r\n                selectedCommunities.length === 0 ||\r\n                selectedCommunities.includes(String(r.getValue(communityColumnId) ?? \"\"));\r\n            const typePass = !selectedType || String(r.getValue(typeColumnId) ?? \"\") === selectedType;\r\n            const yr = String(r.getValue(yearHelperColumnId) ?? \"\");\r\n            const yearPass = !selectedYear || yr === selectedYear;\r\n            return commPass && typePass && yearPass;\r\n        });\r\n        const set = new Set<string>();\r\n        rows.forEach((rr) => {\r\n            const v = String(rr.getValue(categoryColumnId) ?? \"\");\r\n            if (v) set.add(v);\r\n        });\r\n        return Array.from(set).sort((a, b) => a.localeCompare(b)).map((v) => ({ value: v, label: v }));\r\n    }, [\r\n        table,\r\n        communityColumnId,\r\n        typeColumnId,\r\n        categoryColumnId,\r\n        yearHelperColumnId,\r\n        selectedCommunities,\r\n        selectedType,\r\n        selectedYear,\r\n    ]);\r\n\r\n    const anyFilterActive = filters.length > 0;\r\n\r\n    // ----- UI -----\r\n    return (\r\n        <div className=\"flex flex-wrap items-center gap-2 rounded-xl border border-slate-200 bg-white p-3 shadow-sm\">\r\n            {/* Community (multi) */}\r\n            <MultiSelect\r\n                aria-label=\"Filter by community\"\r\n                label=\"Community\"\r\n                values={selectedCommunities}\r\n                options={communityOptions}\r\n                onChange={(vals) => setFilter(communityColumnId, vals)}\r\n                className=\"mr-1\"\r\n            />\r\n\r\n            {/* Year (single) */}\r\n            <SingleSelect\r\n                aria-label=\"Filter by year\"\r\n                label=\"Year\"\r\n                value={selectedYear}\r\n                options={yearOpts}\r\n                onChange={(val) => setFilter(yearHelperColumnId, val)}\r\n                className=\"mr-1\"\r\n            />\r\n\r\n            {/* Budget Type (single) */}\r\n            <SingleSelect\r\n                aria-label=\"Filter by budget type\"\r\n                label=\"Budget Type\"\r\n                value={selectedType}\r\n                options={typeOpts}\r\n                onChange={(val) => setFilter(typeColumnId, val)}\r\n                className=\"mr-1\"\r\n            />\r\n\r\n            {/* Category (multi) */}\r\n            <MultiSelect\r\n                aria-label=\"Filter by category\"\r\n                label=\"Category\"\r\n                values={selectedCategories}\r\n                options={categoryOptions}\r\n                onChange={(vals) => setFilter(categoryColumnId, vals)}\r\n                className=\"mr-1\"\r\n            />\r\n\r\n            {/* Spacer */}\r\n            <div className=\"grow\" />\r\n\r\n            {/* Filters active badge */}\r\n            {anyFilterActive && (\r\n                <span className=\"rounded-full bg-slate-100 px-2 py-1 text-xs font-medium text-slate-600\">\r\n                    {filters.length} filter{filters.length > 1 ? \"s\" : \"\"} active\r\n                </span>\r\n            )}\r\n\r\n            <button\r\n                type=\"button\"\r\n                onClick={onClear}\r\n                className=\"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-500\"\r\n            >\r\n                Clear Filters\r\n            </button>\r\n            <button\r\n                type=\"button\"\r\n                onClick={onExport}\r\n                className=\"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-500\"\r\n            >\r\n                Export CSV\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n\r\n/* ========================== Headless Inputs ========================== */\r\n\r\nfunction useClickOutsideClose<T extends HTMLElement>(onClose: () => void) {\r\n    const ref = React.useRef<T | null>(null);\r\n    React.useEffect(() => {\r\n        const onDocClick = (e: MouseEvent) => {\r\n            if (!ref.current) return;\r\n            if (!ref.current.contains(e.target as Node)) onClose();\r\n        };\r\n        const onEsc = (e: KeyboardEvent) => {\r\n            if (e.key === \"Escape\") onClose();\r\n        };\r\n        document.addEventListener(\"mousedown\", onDocClick);\r\n        document.addEventListener(\"keydown\", onEsc);\r\n        return () => {\r\n            document.removeEventListener(\"mousedown\", onDocClick);\r\n            document.removeEventListener(\"keydown\", onEsc);\r\n        };\r\n    }, [onClose]);\r\n    return ref;\r\n}\r\n\r\nfunction SingleSelect({\r\n    label,\r\n    value,\r\n    options,\r\n    onChange,\r\n    className,\r\n    \"aria-label\": ariaLabel,\r\n}: {\r\n    label: string; // control name when empty\r\n    value: string | null;\r\n    options: Option[];\r\n    onChange: (val: string | null) => void;\r\n    className?: string;\r\n    \"aria-label\"?: string;\r\n}) {\r\n    const [open, setOpen] = React.useState(false);\r\n    const ref = useClickOutsideClose<HTMLDivElement>(() => setOpen(false));\r\n    const current = options.find((o) => o.value === value);\r\n    const displayText = current ? current.label : label;\r\n\r\n    return (\r\n        <div className={`relative ${className ?? \"\"}`} ref={ref}>\r\n            <button\r\n                type=\"button\"\r\n                aria-label={ariaLabel || label}\r\n                onClick={() => setOpen((o) => !o)}\r\n                className=\"inline-flex min-w-[168px] items-center justify-between rounded-md border border-slate-300 bg-white px-2.5 py-1.5 text-sm text-slate-800 shadow-sm hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-500\"\r\n            >\r\n                <span className={`truncate ${current ? \"\" : \"text-slate-500\"}`}>{displayText}</span>\r\n                <Caret />\r\n            </button>\r\n            {open && (\r\n                <div role=\"listbox\" className=\"absolute z-40 mt-1 max-h-64 w-[min(280px,calc(100vw-2rem))] overflow-auto rounded-md border border-slate-200 bg-white p-1 shadow-lg\">\r\n                    <button\r\n                        className=\"w-full rounded px-2 py-1 text-left text-sm text-slate-700 hover:bg-slate-100\"\r\n                        onClick={() => { onChange(null); setOpen(false); }}\r\n                    >\r\n                        All\r\n                    </button>\r\n                    <div className=\"my-1 h-px bg-slate-100\" />\r\n                    {options.map((opt) => (\r\n                        <button\r\n                            key={opt.value}\r\n                            role=\"option\"\r\n                            aria-selected={opt.value === value}\r\n                            className={`w-full rounded px-2 py-1 text-left text-sm hover:bg-slate-100 ${opt.value === value ? \"bg-teal-50 text-teal-700\" : \"text-slate-700\"}`}\r\n                            onClick={() => { onChange(opt.value); setOpen(false); }}\r\n                        >\r\n                            {opt.label}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction MultiSelect({\r\n    label,\r\n    values,\r\n    options,\r\n    onChange,\r\n    searchable = true,\r\n    className,\r\n    \"aria-label\": ariaLabel,\r\n}: {\r\n    label: string; // control name when empty\r\n    values: string[];\r\n    options: Option[];\r\n    onChange: (vals: string[]) => void;\r\n    searchable?: boolean;\r\n    className?: string;\r\n    \"aria-label\"?: string;\r\n}) {\r\n    const [open, setOpen] = React.useState(false);\r\n    const [query, setQuery] = React.useState(\"\");\r\n    const ref = useClickOutsideClose<HTMLDivElement>(() => setOpen(false));\r\n\r\n    const display =\r\n        values.length === 0\r\n            ? label\r\n            : values.length <= 2\r\n                ? options.filter((o) => values.includes(o.value)).map((o) => o.label).join(\", \")\r\n                : `${values.length} selected`;\r\n\r\n    const filtered = React.useMemo(() => {\r\n        if (!searchable || !query.trim()) return options;\r\n        const q = query.toLowerCase();\r\n        return options.filter((o) => o.label.toLowerCase().includes(q));\r\n    }, [options, searchable, query]);\r\n\r\n    const toggle = (val: string) => {\r\n        if (values.includes(val)) onChange(values.filter((v) => v !== val));\r\n        else onChange([...values, val]);\r\n    };\r\n\r\n    const selectAll = () => onChange(options.map((o) => o.value));\r\n    const clearAll = () => onChange([]);\r\n\r\n    return (\r\n        <div className={`relative ${className ?? \"\"}`} ref={ref}>\r\n            <button\r\n                type=\"button\"\r\n                aria-label={ariaLabel || label}\r\n                onClick={() => setOpen((o) => !o)}\r\n                className=\"inline-flex min-w-[220px] items-center justify-between rounded-md border border-slate-300 bg-white px-2.5 py-1.5 text-sm text-slate-800 shadow-sm hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-500\"\r\n            >\r\n                <span className={`truncate ${values.length === 0 ? \"text-slate-500\" : \"\"}`}>{display}</span>\r\n                <Caret />\r\n            </button>\r\n            {open && (\r\n                <div role=\"listbox\" className=\"absolute z-40 mt-1 max-h-72 w-[min(420px,calc(100vw-2rem))] overflow-auto rounded-md border border-slate-200 bg-white p-2 shadow-lg\">\r\n                    {searchable && (\r\n                        <div className=\"mb-2\">\r\n                            <input\r\n                                autoFocus\r\n                                type=\"text\"\r\n                                placeholder=\"Search…\"\r\n                                value={query}\r\n                                onChange={(e) => setQuery(e.target.value)}\r\n                                className=\"w-full rounded border border-slate-300 px-2 py-1 text-sm\"\r\n                            />\r\n                        </div>\r\n                    )}\r\n                    <div className=\"flex items-center justify-between px-1 pb-2\">\r\n                        <div className=\"text-xs text-slate-500\">{options.length} options</div>\r\n                        <div className=\"space-x-2\">\r\n                            <button className=\"rounded bg-slate-100 px-2 py-0.5 text-xs hover:bg-slate-200\" onClick={selectAll}>\r\n                                Select all\r\n                            </button>\r\n                            <button className=\"rounded bg-slate-100 px-2 py-0.5 text-xs hover:bg-slate-200\" onClick={clearAll}>\r\n                                Clear\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <ul className=\"space-y-0.5\">\r\n                        {filtered.map((opt) => {\r\n                            const checked = values.includes(opt.value);\r\n                            return (\r\n                                <li key={opt.value}>\r\n                                    <label className=\"flex cursor-pointer items-center gap-2 rounded px-2 py-1 text-sm hover:bg-slate-50\">\r\n                                        <input\r\n                                            type=\"checkbox\"\r\n                                            className=\"h-3.5 w-3.5 accent-teal-600\"\r\n                                            checked={checked}\r\n                                            onChange={() => toggle(opt.value)}\r\n                                        />\r\n                                        <span className={checked ? \"text-teal-700\" : \"text-slate-700\"}>{opt.label}</span>\r\n                                    </label>\r\n                                </li>\r\n                            );\r\n                        })}\r\n                    </ul>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction Caret() {\r\n    return (\r\n        <svg viewBox=\"0 0 20 20\" aria-hidden=\"true\" className=\"ml-2 h-4 w-4 text-slate-500\">\r\n            <path d=\"M5.25 7.5l4.5 4.5 4.5-4.5\" stroke=\"currentColor\" strokeWidth=\"1.8\" fill=\"none\" strokeLinecap=\"round\" />\r\n        </svg>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 513, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/JeremyJoyner/code/budgetintelligence/components/grid/AmountCell.tsx"],"sourcesContent":["\r\n\"use client\";\r\n\r\nimport * as React from \"react\";\r\n\r\n/**\r\n * AmountCell — standalone inline editor for the \"Amount\" column.\r\n * - Click to enter edit mode\r\n * - Commit on Enter/blur; Escape cancels\r\n * - Persists via table.options.meta.updateRow(rowIndex, { amount: next })\r\n *\r\n * Requirements from parent table:\r\n *   - The TanStack Table instance must define `meta.updateRow(index, partial)`\r\n *     which will update backing data (see BudgetGrid.tanstack.tsx).\r\n */\r\n\r\nexport default function AmountCell({\r\n    getValue,\r\n    row,\r\n    table,\r\n}: {\r\n    getValue: () => number | null | undefined;\r\n    row: any;\r\n    table: any;\r\n}) {\r\n    const initial = getValue();\r\n    const [editing, setEditing] = React.useState(false);\r\n    const [draft, setDraft] = React.useState<number | \"\">(\r\n        typeof initial === \"number\" ? initial : initial == null ? \"\" : Number(initial)\r\n    );\r\n\r\n    // Format helper (display only)\r\n    const fmtUSD = React.useCallback(\r\n        (n: number) =>\r\n            new Intl.NumberFormat(\"en-US\", {\r\n                style: \"currency\",\r\n                currency: \"USD\",\r\n                maximumFractionDigits: 0,\r\n            }).format(n),\r\n        []\r\n    );\r\n\r\n    const commit = () => {\r\n        const next = draft === \"\" ? null : Number(draft);\r\n        table.options.meta?.updateRow?.(row.index, { amount: next });\r\n        setEditing(false);\r\n    };\r\n\r\n    const cancel = () => {\r\n        // Revert to current value in the row\r\n        const current = getValue();\r\n        setDraft(typeof current === \"number\" ? current : current == null ? \"\" : Number(current));\r\n        setEditing(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"text-right\">\r\n            {editing ? (\r\n                <input\r\n                    autoFocus\r\n                    type=\"number\"\r\n                    step={1}\r\n                    className=\"w-full rounded border border-slate-300 px-2 py-1 text-right text-sm\"\r\n                    value={draft}\r\n                    onChange={(e) => setDraft(e.target.value === \"\" ? \"\" : Number(e.target.value))}\r\n                    onBlur={commit}\r\n                    onKeyDown={(e) => {\r\n                        if (e.key === \"Enter\") commit();\r\n                        if (e.key === \"Escape\") cancel();\r\n                    }}\r\n                />\r\n            ) : (\r\n                <button\r\n                    className=\"w-full text-right tabular-nums\"\r\n                    onClick={() => setEditing(true)}\r\n                    title=\"Click to edit\"\r\n                >\r\n                    {typeof initial === \"number\" ? fmtUSD(initial) : \"—\"}\r\n                </button>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AAFA;;;AAee,SAAS,WAAW,EAC/B,QAAQ,EACR,GAAG,EACH,KAAK,EAKR;IACG,MAAM,UAAU;IAChB,MAAM,CAAC,SAAS,WAAW,GAAG,iNAAc,CAAC;IAC7C,MAAM,CAAC,OAAO,SAAS,GAAG,iNAAc,CACpC,OAAO,YAAY,WAAW,UAAU,WAAW,OAAO,KAAK,OAAO;IAG1E,+BAA+B;IAC/B,MAAM,SAAS,oNAAiB,CAC5B,CAAC,IACG,IAAI,KAAK,YAAY,CAAC,SAAS;YAC3B,OAAO;YACP,UAAU;YACV,uBAAuB;QAC3B,GAAG,MAAM,CAAC,IACd,EAAE;IAGN,MAAM,SAAS;QACX,MAAM,OAAO,UAAU,KAAK,OAAO,OAAO;QAC1C,MAAM,OAAO,CAAC,IAAI,EAAE,YAAY,IAAI,KAAK,EAAE;YAAE,QAAQ;QAAK;QAC1D,WAAW;IACf;IAEA,MAAM,SAAS;QACX,qCAAqC;QACrC,MAAM,UAAU;QAChB,SAAS,OAAO,YAAY,WAAW,UAAU,WAAW,OAAO,KAAK,OAAO;QAC/E,WAAW;IACf;IAEA,qBACI,8OAAC;QAAI,WAAU;kBACV,wBACG,8OAAC;YACG,SAAS;YACT,MAAK;YACL,MAAM;YACN,WAAU;YACV,OAAO;YACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK,KAAK,KAAK,OAAO,EAAE,MAAM,CAAC,KAAK;YAC5E,QAAQ;YACR,WAAW,CAAC;gBACR,IAAI,EAAE,GAAG,KAAK,SAAS;gBACvB,IAAI,EAAE,GAAG,KAAK,UAAU;YAC5B;;;;;iCAGJ,8OAAC;YACG,WAAU;YACV,SAAS,IAAM,WAAW;YAC1B,OAAM;sBAEL,OAAO,YAAY,WAAW,OAAO,WAAW;;;;;;;;;;;AAKrE"}},
    {"offset": {"line": 583, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/JeremyJoyner/code/budgetintelligence/components/BudgetGrid.tanstack.tsx"],"sourcesContent":["\r\n\"use client\";\r\n\r\nimport React, { useMemo, useRef, useState } from \"react\";\r\nimport {\r\n    ColumnDef,\r\n    RowSelectionState,\r\n    SortingState,\r\n    ColumnFiltersState,\r\n    getCoreRowModel,\r\n    getFilteredRowModel,\r\n    getSortedRowModel,\r\n    useReactTable,\r\n    flexRender,\r\n    ColumnPinningState,\r\n    GroupingState,\r\n} from \"@tanstack/react-table\";\r\nimport { useVirtualizer } from \"@tanstack/react-virtual\";\r\nimport ToolbarFilters from \"./grid/ToolbarFilters\";\r\nimport AmountCell from \"./grid/AmountCell\";\r\n\r\n// ---------- types ----------\r\nexport type BudgetLine = {\r\n    type: \"revenue\" | \"expense\" | \"home office\" | string;\r\n    community: string;\r\n    category: string;\r\n    subCategory?: string | null;\r\n    budgetMethod?: string | null;\r\n    driver?: string | null;\r\n    driverTag?: string | null;\r\n    glCode?: string | null;\r\n    period?: string | number | null; // e.g., \"2026-01\" or \"2026\"\r\n    amount?: number | null;\r\n};\r\n\r\ntype Props = { rows: BudgetLine[] };\r\n\r\n// ---------- utils ----------\r\nconst fmtUSD = (n: number) =>\r\n    new Intl.NumberFormat(\"en-US\", { style: \"currency\", currency: \"USD\", maximumFractionDigits: 0 }).format(n);\r\n\r\nfunction exportRowsToCsv<T extends object>(rows: T[], columns: ColumnDef<T, any>[], fileName = \"budget-grid.csv\") {\r\n    const colIds = columns\r\n        .map((c) =>\r\n            \"accessorKey\" in c && c.accessorKey ? String(c.accessorKey) : c.id ? String(c.id) : null\r\n        )\r\n        .filter(Boolean) as string[];\r\n\r\n    const esc = (s: any) => {\r\n        if (s == null) return \"\";\r\n        const str = String(s);\r\n        return /[\",\\n]/.test(str) ? `\"${str.replace(/\"/g, '\"\"')}\"` : str;\r\n    };\r\n\r\n    const header = colIds.join(\",\");\r\n    const body = rows\r\n        .map((r) =>\r\n            colIds\r\n                .map((k) => (k === \"amount\" ? (r as any)[k] ?? \"\" : (r as any)[k] ?? \"\"))\r\n                .map(esc)\r\n                .join(\",\")\r\n        )\r\n        .join(\"\\n\");\r\n\r\n    const csv = `${header}\\n${body}`;\r\n    const blob = new Blob([csv], { type: \"text/csv;charset=utf-8\" });\r\n    const a = document.createElement(\"a\");\r\n    a.href = URL.createObjectURL(blob);\r\n    a.download = fileName;\r\n    a.click();\r\n    URL.revokeObjectURL(a.href);\r\n}\r\n\r\n// ---------- main ----------\r\nexport default function BudgetGrid({ rows }: Props) {\r\n    // local states\r\n    const [data, setData] = useState<BudgetLine[]>(() => rows ?? []);\r\n    const [sorting, setSorting] = useState<SortingState>([]);\r\n    const [filters, setFilters] = useState<ColumnFiltersState>([]);\r\n    const [rowSelection, setRowSelection] = useState<RowSelectionState>({});\r\n    const [columnVisibility, setColumnVisibility] = useState<Record<string, boolean>>({});\r\n    const [columnPinning, setColumnPinning] = useState<ColumnPinningState>({ left: [], right: [] });\r\n    const [grouping, setGrouping] = useState<GroupingState>([]);\r\n\r\n    // columns\r\n    const columns = useMemo<ColumnDef<BudgetLine, any>[]>(() => {\r\n        const multiIncludesSome = (row: any, columnId: string, filterValue: string[]) => {\r\n            if (!Array.isArray(filterValue) || filterValue.length === 0) return true;\r\n            const v = String(row.getValue(columnId) ?? \"\");\r\n            return filterValue.includes(v);\r\n        };\r\n        const equalsString = (row: any, columnId: string, filterValue: string | null) => {\r\n            if (!filterValue) return true;\r\n            return String(row.getValue(columnId) ?? \"\") === String(filterValue);\r\n        };\r\n\r\n        return [\r\n            { id: \"community\", accessorKey: \"community\", header: \"Community\", meta: { filterPlaceholder: \"filter…\" }, filterFn: multiIncludesSome, enablePinning: true },\r\n            { id: \"type\", accessorKey: \"type\", header: \"Type\", size: 130, filterFn: equalsString },\r\n            { id: \"category\", accessorKey: \"category\", header: \"Category\", filterFn: multiIncludesSome },\r\n            { id: \"subCategory\", accessorKey: \"subCategory\", header: \"Subcategory\" },\r\n            { id: \"period\", accessorKey: \"period\", header: \"Period\", size: 120 },\r\n            { id: \"glCode\", accessorKey: \"glCode\", header: \"GL Code\", size: 120 },\r\n            { id: \"budgetMethod\", accessorKey: \"budgetMethod\", header: \"Method\", size: 180 },\r\n            { id: \"driver\", header: \"Driver\", accessorFn: (row) => row.driver ?? row.driverTag ?? null },\r\n            { id: \"amount\", accessorKey: \"amount\", header: \"Amount\", cell: AmountCell, size: 140 },\r\n\r\n            // Hidden helper column for Year filtering derived from period (\"YYYY\" or \"YYYY-MM\")\r\n            {\r\n                id: \"__year\",\r\n                accessorFn: (row) => {\r\n                    const s = String(row.period ?? \"\");\r\n                    const y = s.slice(0, 4);\r\n                    return /^\\d{4}$/.test(y) ? y : null;\r\n                },\r\n                header: \"Year (hidden)\",\r\n                enableHiding: true,\r\n                meta: { hiddenHelper: true },\r\n                filterFn: (r, id, val: string | null) => !val || String(r.getValue(id) ?? \"\") === String(val),\r\n            },\r\n        ];\r\n    }, []);\r\n\r\n    // table\r\n    const table = useReactTable({\r\n        data,\r\n        columns,\r\n        getCoreRowModel: getCoreRowModel(),\r\n        getFilteredRowModel: getFilteredRowModel(),\r\n        getSortedRowModel: getSortedRowModel(),\r\n        state: { sorting, columnFilters: filters, rowSelection, columnVisibility, columnPinning, grouping },\r\n        onSortingChange: setSorting,\r\n        onColumnFiltersChange: setFilters,\r\n        onRowSelectionChange: setRowSelection,\r\n        onColumnVisibilityChange: setColumnVisibility,\r\n        onColumnPinningChange: setColumnPinning,\r\n        onGroupingChange: setGrouping,\r\n        enableRowSelection: true,\r\n        meta: {\r\n            updateRow: (rowIndex: number, partial: Partial<BudgetLine>) => {\r\n                setData((old) => {\r\n                    const next = old.slice();\r\n                    next[rowIndex] = { ...next[rowIndex], ...partial };\r\n                    return next;\r\n                });\r\n            },\r\n        },\r\n        getRowId: (row) =>\r\n            `${row.community ?? \"\"}${row.type ?? \"\"}${row.category ?? \"\"}${row.subCategory ?? \"\"}${row.period ?? \"\"}`,\r\n    });\r\n\r\n    // toolbar actions\r\n    const clearAllFilters = () => setFilters([]);\r\n    const exportCsv = () => {\r\n        const out = table.getRowModel().rows.map((r) => r.original);\r\n        exportRowsToCsv(out, columns);\r\n    };\r\n\r\n    // virtualization\r\n    const parentRef = useRef<HTMLDivElement>(null);\r\n    const virtualizer = useVirtualizer({\r\n        count: table.getRowModel().rows.length,\r\n        getScrollElement: () => parentRef.current,\r\n        estimateSize: () => 40,\r\n        overscan: 8,\r\n    });\r\n    const virtualItems = virtualizer.getVirtualItems();\r\n\r\n    // totals\r\n    const totalFiltered = useMemo(() => {\r\n        let sum = 0;\r\n        for (const r of table.getFilteredRowModel().rows) {\r\n            const v = r.original.amount;\r\n            if (typeof v === \"number\") sum += v;\r\n        }\r\n        return sum;\r\n    }, [table, data, filters, sorting, grouping]);\r\n\r\n    return (\r\n        <section aria-label=\"Budget grid\" className=\"space-y-3\">\r\n            {/* Toolbar (sibling component) */}\r\n            <ToolbarFilters\r\n                table={table}\r\n                filters={filters}\r\n                setFilters={setFilters}\r\n                onClear={clearAllFilters}\r\n                onExport={exportCsv}\r\n            />\r\n\r\n            {/* Column headers + simple text filters */}\r\n            <div className=\"rounded-t-lg border-x border-t border-slate-200 bg-slate-50\">\r\n                <div\r\n                    className=\"grid grid-cols-[repeat(var(--cols),minmax(140px,1fr))] px-2 py-2 text-xs font-semibold text-slate-600\"\r\n                    style={{\r\n                        [\"--cols\" as any]: table\r\n                            .getAllColumns()\r\n                            .filter((c) => c.getIsVisible() && !(c.columnDef as any)?.meta?.hiddenHelper).length,\r\n                    }}\r\n                >\r\n                    {table.getFlatHeaders().map((header) => {\r\n                        if ((header.column.columnDef as any)?.meta?.hiddenHelper) return null;\r\n                        return (\r\n                            <div key={header.id} className=\"pr-2\">\r\n                                <button\r\n                                    className=\"inline-flex items-center gap-1 hover:text-slate-900\"\r\n                                    onClick={header.column.getToggleSortingHandler()}\r\n                                    title=\"Click to sort\"\r\n                                >\r\n                                    {flexRender(header.column.columnDef.header, header.getContext())}\r\n                                    {{\r\n                                        asc: \" ↑\",\r\n                                        desc: \" ↓\",\r\n                                    }[header.column.getIsSorted() as string] ?? null}\r\n                                </button>\r\n                                {header.column.getCanFilter() && (\r\n                                    <div className=\"mt-1\">\r\n                                        <input\r\n                                            className=\"w-full rounded border border-slate-300 px-1.5 py-1 text-xs\"\r\n                                            placeholder={(header.column.columnDef as any).meta?.filterPlaceholder ?? \"filter…\"}\r\n                                            value={(header.column.getFilterValue() as string) ?? \"\"}\r\n                                            onChange={(e) => header.column.setFilterValue(e.target.value)}\r\n                                        />\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Body (virtualized rows) */}\r\n            <div\r\n                ref={parentRef}\r\n                className=\"border-x border-b border-slate-200\"\r\n                style={{ height: 720, overflow: \"auto\", position: \"relative\" }}\r\n                aria-label=\"Budget TanStack Grid\"\r\n            >\r\n                <div style={{ height: virtualizer.getTotalSize(), position: \"relative\" }}>\r\n                    {virtualItems.map((vi) => {\r\n                        const row = table.getRowModel().rows[vi.index];\r\n                        const visibleCols = row.getVisibleCells().filter((c) => !(c.column.columnDef as any)?.meta?.hiddenHelper);\r\n                        return (\r\n                            <div\r\n                                key={row.id}\r\n                                className={`grid grid-cols-[repeat(var(--cols),minmax(140px,1fr))] border-b border-slate-100 px-2 text-sm ${row.getIsSelected() ? \"bg-teal-50\" : \"bg-white\"\r\n                                    } hover:bg-slate-50`}\r\n                                style={{\r\n                                    transform: `translateY(${vi.start}px)`,\r\n                                    [\"--cols\" as any]: visibleCols.length,\r\n                                    height: vi.size,\r\n                                    alignItems: \"center\",\r\n                                }}\r\n                                onClick={() => row.toggleSelected()}\r\n                            >\r\n                                {visibleCols.map((cell) => (\r\n                                    <div key={cell.id} className=\"pr-2\">\r\n                                        {flexRender(cell.column.columnDef.cell, cell.getContext())}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Pinned TOTAL (filtered) */}\r\n            <div className=\"rounded-b-lg border border-teal-200 bg-teal-50 px-3 py-2 text-sm font-semibold text-teal-800\">\r\n                TOTAL (filtered): <span className=\"tabular-nums\">{fmtUSD(totalFiltered)}</span>\r\n            </div>\r\n        </section>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AAaA;AACA;AACA;AAlBA;;;;;;;AAoCA,8BAA8B;AAC9B,MAAM,SAAS,CAAC,IACZ,IAAI,KAAK,YAAY,CAAC,SAAS;QAAE,OAAO;QAAY,UAAU;QAAO,uBAAuB;IAAE,GAAG,MAAM,CAAC;AAE5G,SAAS,gBAAkC,IAAS,EAAE,OAA4B,EAAE,WAAW,iBAAiB;IAC5G,MAAM,SAAS,QACV,GAAG,CAAC,CAAC,IACF,iBAAiB,KAAK,EAAE,WAAW,GAAG,OAAO,EAAE,WAAW,IAAI,EAAE,EAAE,GAAG,OAAO,EAAE,EAAE,IAAI,MAEvF,MAAM,CAAC;IAEZ,MAAM,MAAM,CAAC;QACT,IAAI,KAAK,MAAM,OAAO;QACtB,MAAM,MAAM,OAAO;QACnB,OAAO,SAAS,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,IAAI,OAAO,CAAC,MAAM,MAAM,CAAC,CAAC,GAAG;IACjE;IAEA,MAAM,SAAS,OAAO,IAAI,CAAC;IAC3B,MAAM,OAAO,KACR,GAAG,CAAC,CAAC,IACF,OACK,GAAG,CAAC,CAAC,IAAO,MAAM,WAAW,AAAC,CAAS,CAAC,EAAE,IAAI,KAAK,AAAC,CAAS,CAAC,EAAE,IAAI,IACpE,GAAG,CAAC,KACJ,IAAI,CAAC,MAEb,IAAI,CAAC;IAEV,MAAM,MAAM,GAAG,OAAO,EAAE,EAAE,MAAM;IAChC,MAAM,OAAO,IAAI,KAAK;QAAC;KAAI,EAAE;QAAE,MAAM;IAAyB;IAC9D,MAAM,IAAI,SAAS,aAAa,CAAC;IACjC,EAAE,IAAI,GAAG,IAAI,eAAe,CAAC;IAC7B,EAAE,QAAQ,GAAG;IACb,EAAE,KAAK;IACP,IAAI,eAAe,CAAC,EAAE,IAAI;AAC9B;AAGe,SAAS,WAAW,EAAE,IAAI,EAAS;IAC9C,eAAe;IACf,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAe,IAAM,QAAQ,EAAE;IAC/D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAe,EAAE;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAqB,EAAE;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAoB,CAAC;IACrE,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAA0B,CAAC;IACnF,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAqB;QAAE,MAAM,EAAE;QAAE,OAAO,EAAE;IAAC;IAC7F,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAgB,EAAE;IAE1D,UAAU;IACV,MAAM,UAAU,IAAA,gNAAO,EAA+B;QAClD,MAAM,oBAAoB,CAAC,KAAU,UAAkB;YACnD,IAAI,CAAC,MAAM,OAAO,CAAC,gBAAgB,YAAY,MAAM,KAAK,GAAG,OAAO;YACpE,MAAM,IAAI,OAAO,IAAI,QAAQ,CAAC,aAAa;YAC3C,OAAO,YAAY,QAAQ,CAAC;QAChC;QACA,MAAM,eAAe,CAAC,KAAU,UAAkB;YAC9C,IAAI,CAAC,aAAa,OAAO;YACzB,OAAO,OAAO,IAAI,QAAQ,CAAC,aAAa,QAAQ,OAAO;QAC3D;QAEA,OAAO;YACH;gBAAE,IAAI;gBAAa,aAAa;gBAAa,QAAQ;gBAAa,MAAM;oBAAE,mBAAmB;gBAAU;gBAAG,UAAU;gBAAmB,eAAe;YAAK;YAC3J;gBAAE,IAAI;gBAAQ,aAAa;gBAAQ,QAAQ;gBAAQ,MAAM;gBAAK,UAAU;YAAa;YACrF;gBAAE,IAAI;gBAAY,aAAa;gBAAY,QAAQ;gBAAY,UAAU;YAAkB;YAC3F;gBAAE,IAAI;gBAAe,aAAa;gBAAe,QAAQ;YAAc;YACvE;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAU,MAAM;YAAI;YACnE;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAW,MAAM;YAAI;YACpE;gBAAE,IAAI;gBAAgB,aAAa;gBAAgB,QAAQ;gBAAU,MAAM;YAAI;YAC/E;gBAAE,IAAI;gBAAU,QAAQ;gBAAU,YAAY,CAAC,MAAQ,IAAI,MAAM,IAAI,IAAI,SAAS,IAAI;YAAK;YAC3F;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAU,MAAM,4IAAU;gBAAE,MAAM;YAAI;YAErF,oFAAoF;YACpF;gBACI,IAAI;gBACJ,YAAY,CAAC;oBACT,MAAM,IAAI,OAAO,IAAI,MAAM,IAAI;oBAC/B,MAAM,IAAI,EAAE,KAAK,CAAC,GAAG;oBACrB,OAAO,UAAU,IAAI,CAAC,KAAK,IAAI;gBACnC;gBACA,QAAQ;gBACR,cAAc;gBACd,MAAM;oBAAE,cAAc;gBAAK;gBAC3B,UAAU,CAAC,GAAG,IAAI,MAAuB,CAAC,OAAO,OAAO,EAAE,QAAQ,CAAC,OAAO,QAAQ,OAAO;YAC7F;SACH;IACL,GAAG,EAAE;IAEL,QAAQ;IACR,MAAM,QAAQ,IAAA,uMAAa,EAAC;QACxB;QACA;QACA,iBAAiB,IAAA,wLAAe;QAChC,qBAAqB,IAAA,4LAAmB;QACxC,mBAAmB,IAAA,0LAAiB;QACpC,OAAO;YAAE;YAAS,eAAe;YAAS;YAAc;YAAkB;YAAe;QAAS;QAClG,iBAAiB;QACjB,uBAAuB;QACvB,sBAAsB;QACtB,0BAA0B;QAC1B,uBAAuB;QACvB,kBAAkB;QAClB,oBAAoB;QACpB,MAAM;YACF,WAAW,CAAC,UAAkB;gBAC1B,QAAQ,CAAC;oBACL,MAAM,OAAO,IAAI,KAAK;oBACtB,IAAI,CAAC,SAAS,GAAG;wBAAE,GAAG,IAAI,CAAC,SAAS;wBAAE,GAAG,OAAO;oBAAC;oBACjD,OAAO;gBACX;YACJ;QACJ;QACA,UAAU,CAAC,MACP,GAAG,IAAI,SAAS,IAAI,KAAK,IAAI,IAAI,IAAI,KAAK,IAAI,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,KAAK,IAAI,MAAM,IAAI,IAAI;IACjH;IAEA,kBAAkB;IAClB,MAAM,kBAAkB,IAAM,WAAW,EAAE;IAC3C,MAAM,YAAY;QACd,MAAM,MAAM,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,IAAM,EAAE,QAAQ;QAC1D,gBAAgB,KAAK;IACzB;IAEA,iBAAiB;IACjB,MAAM,YAAY,IAAA,+MAAM,EAAiB;IACzC,MAAM,cAAc,IAAA,wMAAc,EAAC;QAC/B,OAAO,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM;QACtC,kBAAkB,IAAM,UAAU,OAAO;QACzC,cAAc,IAAM;QACpB,UAAU;IACd;IACA,MAAM,eAAe,YAAY,eAAe;IAEhD,SAAS;IACT,MAAM,gBAAgB,IAAA,gNAAO,EAAC;QAC1B,IAAI,MAAM;QACV,KAAK,MAAM,KAAK,MAAM,mBAAmB,GAAG,IAAI,CAAE;YAC9C,MAAM,IAAI,EAAE,QAAQ,CAAC,MAAM;YAC3B,IAAI,OAAO,MAAM,UAAU,OAAO;QACtC;QACA,OAAO;IACX,GAAG;QAAC;QAAO;QAAM;QAAS;QAAS;KAAS;IAE5C,qBACI,8OAAC;QAAQ,cAAW;QAAc,WAAU;;0BAExC,8OAAC,gJAAc;gBACX,OAAO;gBACP,SAAS;gBACT,YAAY;gBACZ,SAAS;gBACT,UAAU;;;;;;0BAId,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBACG,WAAU;oBACV,OAAO;wBACH,CAAC,SAAgB,EAAE,MACd,aAAa,GACb,MAAM,CAAC,CAAC,IAAM,EAAE,YAAY,MAAM,CAAE,EAAE,SAAS,EAAU,MAAM,cAAc,MAAM;oBAC5F;8BAEC,MAAM,cAAc,GAAG,GAAG,CAAC,CAAC;wBACzB,IAAK,OAAO,MAAM,CAAC,SAAS,EAAU,MAAM,cAAc,OAAO;wBACjE,qBACI,8OAAC;4BAAoB,WAAU;;8CAC3B,8OAAC;oCACG,WAAU;oCACV,SAAS,OAAO,MAAM,CAAC,uBAAuB;oCAC9C,OAAM;;wCAEL,IAAA,oMAAU,EAAC,OAAO,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,OAAO,UAAU;wCAC5D;4CACG,KAAK;4CACL,MAAM;wCACV,CAAC,CAAC,OAAO,MAAM,CAAC,WAAW,GAAa,IAAI;;;;;;;gCAE/C,OAAO,MAAM,CAAC,YAAY,oBACvB,8OAAC;oCAAI,WAAU;8CACX,cAAA,8OAAC;wCACG,WAAU;wCACV,aAAa,AAAC,OAAO,MAAM,CAAC,SAAS,CAAS,IAAI,EAAE,qBAAqB;wCACzE,OAAO,AAAC,OAAO,MAAM,CAAC,cAAc,MAAiB;wCACrD,UAAU,CAAC,IAAM,OAAO,MAAM,CAAC,cAAc,CAAC,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;2BAlBlE,OAAO,EAAE;;;;;oBAwB3B;;;;;;;;;;;0BAKR,8OAAC;gBACG,KAAK;gBACL,WAAU;gBACV,OAAO;oBAAE,QAAQ;oBAAK,UAAU;oBAAQ,UAAU;gBAAW;gBAC7D,cAAW;0BAEX,cAAA,8OAAC;oBAAI,OAAO;wBAAE,QAAQ,YAAY,YAAY;wBAAI,UAAU;oBAAW;8BAClE,aAAa,GAAG,CAAC,CAAC;wBACf,MAAM,MAAM,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,KAAK,CAAC;wBAC9C,MAAM,cAAc,IAAI,eAAe,GAAG,MAAM,CAAC,CAAC,IAAM,CAAE,EAAE,MAAM,CAAC,SAAS,EAAU,MAAM;wBAC5F,qBACI,8OAAC;4BAEG,WAAW,CAAC,8FAA8F,EAAE,IAAI,aAAa,KAAK,eAAe,WAC5I,kBAAkB,CAAC;4BACxB,OAAO;gCACH,WAAW,CAAC,WAAW,EAAE,GAAG,KAAK,CAAC,GAAG,CAAC;gCACtC,CAAC,SAAgB,EAAE,YAAY,MAAM;gCACrC,QAAQ,GAAG,IAAI;gCACf,YAAY;4BAChB;4BACA,SAAS,IAAM,IAAI,cAAc;sCAEhC,YAAY,GAAG,CAAC,CAAC,qBACd,8OAAC;oCAAkB,WAAU;8CACxB,IAAA,oMAAU,EAAC,KAAK,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,UAAU;mCADjD,KAAK,EAAE;;;;;2BAZhB,IAAI,EAAE;;;;;oBAkBvB;;;;;;;;;;;0BAKR,8OAAC;gBAAI,WAAU;;oBAA+F;kCACxF,8OAAC;wBAAK,WAAU;kCAAgB,OAAO;;;;;;;;;;;;;;;;;;AAIzE"}}]
}